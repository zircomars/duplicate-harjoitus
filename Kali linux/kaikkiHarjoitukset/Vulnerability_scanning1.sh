#############
# harjoitus; https://edu.anarcho-copy.org/Against%20Security%20-%20Self%20Security/Offensive%20Security%20-%20Pentesting%20with%20Kali%20(PWK).pdf
# chapter 4. active information gathering
# sivu START HERE: 131 - 

# samat harjoitukset, lyhyet ja ytimekäs kuvaus ja scriptit: https://github.com/muckitymuck/OSCP-Study-Guide/blob/master/enumeration/active_information_gathering.md 

#######################################################################################################
####### Vulnerability scanning ##########

# Haavoittuvuustarkistus on prosessi, jossa käytetään automaattisia työkaluja verkon haavoittuvuuksien löytämisen ja tunnistamista.
# Haavoittuvuusskannereita on monissa eri muodoissa, yksinkertaisista skripteistä, jotka tunnistavat yhden haavoittuvuuden, monimutkaisiin kaupallisiin ohjelmistoihin, moottorit, jotka etsivät niitä tuhansia.


# Haavoittuvuustarkistukset voivat tuottaa paljon liikennettä ja joissain tapauksissa jopa johtaa palvelunestoehtoihin (denial-of-service attack) monissa verkkolaitteissa, joten varovaisuutta on noudatettava ennen massahaavoittuvuusskannerien käyttöä tunkeutumistestissä.
​
# Porttiskannaus moduulissa käsiteltiin lyhyesti Nmap NSE -skriptejä. Nmap NSE -komentosarjoja voidaan käyttää paitsi luetteloimiseen myös tarkan haavoittuvuustarkistuksen suorittamiseen. Kaikki NSE-komento scriptit sijaitsevat /usr/share/nmap/scripts-kansiossa

┌──(kali㉿kali)-[~]
└─$ cd /usr/share/nmap/scripts/
                                                                                             
┌──(kali㉿kali)-[/usr/share/nmap/scripts]
└─$ ls -l *vuln*
-rw-r--r-- 1 root root  7001 Jan 10  2023 afp-path-vuln.nse
-rw-r--r-- 1 root root  5923 Jan 10  2023 ftp-vuln-cve2010-4221.nse
-rw-r--r-- 1 root root  6973 Jan 10  2023 http-huawei-hg5xx-vuln.nse
-rw-r--r-- 1 root root  7921 Jan 10  2023 http-iis-webdav-vuln.nse
-rw-r--r-- 1 root root  4111 Jan 10  2023 http-vmware-path-vuln.nse
-rw-r--r-- 1 root root  3273 Jan 10  2023 http-vuln-cve2006-3392.nse
-rw-r--r-- 1 root root  6610 Jan 10  2023 http-vuln-cve2009-3960.nse
-rw-r--r-- 1 root root  2957 Jan 10  2023 http-vuln-cve2010-0738.nse
-rw-r--r-- 1 root root  5607 Jan 10  2023 http-vuln-cve2010-2861.nse
....


############### 
# NSE-scripteillä tapahtuvien haavoittuvuus tarkistuksena voidaan käyttää mm. "http-vuln-cve2010-2861", komento scriptinä Cold FUsion-verkkopalvleimen hakemistoon läpikulkua haavoittuvuuden varalta

root@kali:~# nmap -v -p 80 --script=http-vuln-cve2010-2861 10.11.1.210
Starting Nmap 6.25 ( http://nmap.org ) at 2013-06-17 10:28 MDT
NSE: Loaded 1 scripts for scanning.
NSE: Script Pre-scanning.
Initiating Ping Scan at 10:28
Scanning 10.11.1.210 [4 ports]
Completed Ping Scan at 10:28, 0.22s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 10:28
Completed Parallel DNS resolution of 1 host. at 10:28, 0.00s elapsed
Initiating SYN Stealth Scan at 10:28
Scanning 10.11.1.210 [1 port]
Discovered open port 80/tcp on 10.11.1.210
Completed SYN Stealth Scan at 10:28, 0.10s elapsed (1 total ports)
NSE: Script scanning 10.11.1.210.
Initiating NSE at 10:28
Completed NSE at 10:28, 2.08s elapsed
Nmap scan report for 10.11.1.210
Host is up (0.19s latency).
PORT STATE SERVICE
80/tcp open http
| http-vuln-cve2010-2861:
| VULNERABLE:
| Adobe ColdFusion Directory Traversal Vulnerability
| State: VULNERABLE (Exploitable)
| IDs: OSVDB:67047 CVE:CVE-2010-2861
| Description:
| Multiple directory traversal vulnerabilities in the administrator console
| in Adobe ColdFusion 9.0.1 and earlier allow remote attackers to read
arbitrary files via the
| locale parameter
| Disclosure date: 2010-08-10
| Extra information:
|
| CFusionMX
| Not vulnerable
| JRun4\servers
| Not vulnerable
| ColdFusion8
| HMAC: 446EF3D6B348522E29F72ED6BB19A6BE9867A42C
| Salt: 1371461992204
| Hash: AAFDC23870ECBCD3D557B6423A8982134E17927E
| CFusionMX7
| Not vulnerable
|
| References:
| http://osvdb.org/67047
| http://www.nessus.org/plugins/index.php?view=single&id=48340
| http://www.blackhatacademy.org/security101/Cold_Fusion_Hacking
| http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2010-2861
|_ http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2861
NSE: Script Post-scanning.
Read data files from: /usr/bin/../share/nmap
Nmap done: 1 IP address (1 host up) scanned in 2.54 seconds
 Raw packets sent: 5 (196B) | Rcvd: 2 (84B)

### oma badstore skannattu IP-osoite

┌──(root㉿kali)-[/home]
└─#  nmap -v -p 80 --script=http-vuln-cve2010-2861 140.238.50.129
Starting Nmap 7.93 ( https://nmap.org ) at 2023-11-12 16:29 EET
NSE: Loaded 1 scripts for scanning.
NSE: Script Pre-scanning.
Initiating NSE at 16:29
Completed NSE at 16:29, 0.00s elapsed
Initiating ARP Ping Scan at 16:29
Scanning 140.238.50.129 [1 port]
Completed ARP Ping Scan at 16:29, 0.08s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 16:29
Completed Parallel DNS resolution of 1 host. at 16:29, 0.05s elapsed
Initiating SYN Stealth Scan at 16:29
Scanning 140.238.50.129 [1 port]
Discovered open port 80/tcp on 140.238.50.129
Completed SYN Stealth Scan at 16:29, 0.04s elapsed (1 total ports)
NSE: Script scanning 140.238.50.129.
Initiating NSE at 16:29
Completed NSE at 16:29, 0.03s elapsed
Nmap scan report for 140.238.50.129
Host is up (0.00098s latency).

PORT   STATE SERVICE
80/tcp open  http
MAC Address: 40:2c:c5:15:b0:7f (VMware)

NSE: Script Post-scanning.
Initiating NSE at 16:29
Completed NSE at 16:29, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
Nmap done: 1 IP address (1 host up) scanned in 0.78 seconds
           Raw packets sent: 2 (72B) | Rcvd: 2 (72B)
                                                                                             
┌──(root㉿kali)-[/home]
└─# 

# Vääriin kiinnitetyt tai suojatut FTP-palvelimet voivat usein tarjota paljon tietoa ja joskus johtavat palvelimen täydellisen vaarantumista.
# ftp-anon NSE-komento scriptin kautta voidaan nopeasti skannata useita IP-osoiteitta (IP range:lla) FTP-palvelimille, jotka muodostavat mahdollisen anonyymin käytön

root@kali:~# nmap -v -p 21 --script=ftp-anon.nse 10.11.1.1-254
...
Nmap scan report for 10.11.1.217
Host is up (0.19s latency).
PORT STATE SERVICE
21/tcp open ftp
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
| total 20
| d--------- 2 root ftp 4096 Jun 12 07:49 =
| d--x--x--x 2 root root 4096 Jan 18 2007 bin
| d--x--x--x 2 root root 4096 Jan 18 2007 etc
| drwxr-xr-x 2 root root 4096 Jan 18 2007 lib
|_drwxr-sr-x 2 root ftp 4096 Feb 4 2000 pub

##########
## oma badstore skannattu FTP IP-osoite
┌──(kali㉿kali)-[/home]
└─$ nmap -v -p 21 --script=ftp-anon.nse 140.238.50.120-135
Starting Nmap 7.93 ( https://nmap.org ) at 2023-11-12 17:13 EET
NSE: Loaded 1 scripts for scanning.
NSE: Script Pre-scanning.
Initiating NSE at 17:13
Completed NSE at 17:13, 0.00s elapsed
Initiating Ping Scan at 17:13
Scanning 16 hosts [2 ports/host]
Completed Ping Scan at 17:13, 1.55s elapsed (16 total hosts)
Initiating Parallel DNS resolution of 2 hosts. at 17:13
Completed Parallel DNS resolution of 2 hosts. at 17:13, 0.04s elapsed
Nmap scan report for 140.238.50.120 [host down]
Nmap scan report for 140.238.50.121 [host down]
Nmap scan report for 140.238.50.122 [host down]
Nmap scan report for 140.238.50.123 [host down]
Nmap scan report for 140.238.50.124 [host down]
Nmap scan report for 140.238.50.125 [host down]
Nmap scan report for 140.238.50.126 [host down]
Nmap scan report for 140.238.50.127 [host down]
Nmap scan report for 140.238.50.128 [host down]
Nmap scan report for 140.238.50.131 [host down]
Nmap scan report for 140.238.50.132 [host down]
Nmap scan report for 140.238.50.133 [host down]
Nmap scan report for 140.238.50.134 [host down]
Nmap scan report for 140.238.50.135 [host down]
Initiating Connect Scan at 17:13
Scanning 2 hosts [1 port/host]
Completed Connect Scan at 17:13, 0.00s elapsed (2 total ports)
NSE: Script scanning 2 hosts.
Initiating NSE at 17:13
Completed NSE at 17:13, 0.00s elapsed
Nmap scan report for 140.238.50.129
Host is up (0.0032s latency).

PORT   STATE  SERVICE
21/tcp closed ftp

Nmap scan report for 140.238.50.130
Host is up (0.00048s latency).

PORT   STATE  SERVICE
21/tcp closed ftp

NSE: Script Post-scanning.
Initiating NSE at 17:13
Completed NSE at 17:13, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
Nmap done: 16 IP addresses (2 hosts up) scanned in 1.95 seconds





























































